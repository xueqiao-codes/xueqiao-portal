(function(e){function t(t){for(var i,n,o=t[0],r=t[1],c=t[2],m=0,d=[];m<o.length;m++)n=o[m],a[n]&&d.push(a[n][0]),a[n]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);u&&u(t);while(d.length)d.shift()();return l.push.apply(l,c||[]),s()}function s(){for(var e,t=0;t<l.length;t++){for(var s=l[t],i=!0,o=1;o<s.length;o++){var r=s[o];0!==a[r]&&(i=!1)}i&&(l.splice(t--,1),e=n(n.s=s[0]))}return e}var i={},a={app:0},l=[];function n(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=i,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=r;l.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";var i=s("64a9"),a=s.n(i);a.a},"089a":function(e,t,s){},"0b76":function(e,t,s){"use strict";var i=s("2c48"),a=s.n(i);a.a},"0df9":function(e,t,s){"use strict";var i=s("8099"),a=s.n(i);a.a},1101:function(e,t,s){},"1ca1":function(e,t,s){},"267d":function(e,t,s){},"2c48":function(e,t,s){},"337d":function(e,t,s){},"37c6":function(e,t,s){},"4b46":function(e,t,s){},"4ef7":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var i=s("2b0e"),a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},l=[],n=(s("034f"),s("2877")),o={},r=Object(n["a"])(o,a,l,!1,null,null,null),c=r.exports,u=s("8c4f"),m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"breadcrumb"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},e._l(e.$store.state.navigationStack,function(t,i){return s("el-breadcrumb-item",{key:i,attrs:{to:t.router}},[e._v("\n        "+e._s(t.name)+"\n      ")])}),1)],1),s("div",{staticClass:"main"},[s("el-row",{staticClass:"tac"},[s("el-col",{attrs:{span:3}},[s("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"1"}},[s("el-menu-item",{attrs:{index:"1"},on:{click:e.gotoSendingMessagePage}},[s("span",{attrs:{slot:"title"},slot:"title"},[e._v("发送通知")])]),s("el-menu-item",{attrs:{index:"2"},on:{click:e.gotoSentMessagePage}},[s("span",{attrs:{slot:"title"},slot:"title"},[e._v("已发送")])]),s("el-menu-item",{attrs:{index:"3"},on:{click:e.gotoErrorSentMessagePage}},[s("span",{attrs:{slot:"title"},slot:"title"},[e._v("异常通知")])]),s("el-menu-item",{attrs:{index:"4"},on:{click:e.gotoTemplatePage}},[s("a",{attrs:{slot:"title"},slot:"title"},[e._v("模板管理")])])],1)],1),s("el-col",{attrs:{span:21}},[s("router-view")],1)],1)],1)])},d=[],h={name:"home",components:{},data:function(){return{defaultIndex:1}},mounted:function(){this.defaultIndex=1},methods:{gotoSendingMessagePage:function(){this.$router.push("/sending")},gotoSentMessagePage:function(){this.$router.push("/sent")},gotoErrorSentMessagePage:function(){this.$router.push("/errorMessage")},gotoTemplatePage:function(){this.$router.push("/template")}}},p=h,v=(s("0b76"),Object(n["a"])(p,m,d,!1,null,"4e7025b7",null)),g=v.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"sm-item"},[e._m(0),s("div",{staticClass:"sm-item-value"},[s("el-select",{staticClass:"sm-item-value",attrs:{filterable:"",placeholder:"选择模板"},on:{change:e.onTemplateOptionChange},model:{value:e.selectedTemplateOption,callback:function(t){e.selectedTemplateOption=t},expression:"selectedTemplateOption"}},e._l(e.templateOptions,function(e){return s("el-option",{key:e.templateId,attrs:{label:e.templateName,value:e.templateId}})}),1)],1)]),s("div",{staticClass:"item-divider"}),s("div",{staticClass:"sm-item"},[e._m(1),s("div",{staticClass:"sm-item-value long-item-value"},[s("el-checkbox-group",{model:{value:e.selectedChannelList,callback:function(t){e.selectedChannelList=t},expression:"selectedChannelList"}},[s("el-checkbox",{attrs:{label:"4"}},[e._v("客户端消息")]),s("el-checkbox",{attrs:{label:"1"}},[e._v("电子邮件")]),s("el-checkbox",{attrs:{label:"2"}},[e._v("手机短信")])],1)],1)]),s("div",{staticClass:"lg-item"},[e._m(2),s("div",{staticClass:"lg-item-multi-line-value"},[s("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",placeholder:"所有公司"},on:{change:e.onCompanyOptionsChange},model:{value:e.selectedCompanyList,callback:function(t){e.selectedCompanyList=t},expression:"selectedCompanyList"}},e._l(e.companyOptions,function(e){return s("el-option",{key:e.companyId,attrs:{label:e.companyCode,value:e.companyId}})}),1),s("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",disabled:e.disableGroupSelector,placeholder:"所有管机组"},model:{value:e.selectedGroupList,callback:function(t){e.selectedGroupList=t},expression:"selectedGroupList"}},e._l(e.groupOptions,function(e){return s("el-option",{key:e.groupId,attrs:{label:e.groupName,value:e.groupId}})}),1),s("div",{staticClass:"lg-item-multi-line-value receiver-item-value"},[s("el-checkbox-group",{model:{value:e.selectedRoleList,callback:function(t){e.selectedRoleList=t},expression:"selectedRoleList"}},[s("el-checkbox",{attrs:{label:"1"}},[e._v("交易员")]),s("el-checkbox",{attrs:{label:"2"}},[e._v("管理员")])],1)],1)],1)]),s("div",{staticClass:"sm-item"},[e._m(3),s("div",{staticClass:"sm-item-value"},[s("el-select",{staticClass:"sm-item-value",attrs:{filterable:"",placeholder:"请选择通知类型"},model:{value:e.selectedType,callback:function(t){e.selectedType=t},expression:"selectedType"}},e._l(e.M_TYPE,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1)],1)]),s("div",{staticClass:"sm-item"},[e._m(4),s("div",{staticClass:"sm-item-value"},[s("el-select",{staticClass:"sm-item-value",attrs:{filterable:"",placeholder:"请选择通知等级"},model:{value:e.selectedLevel,callback:function(t){e.selectedLevel=t},expression:"selectedLevel"}},e._l(e.M_LEVEL,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1)],1)]),s("div",{staticClass:"sm-item"},[e._m(5),s("div",{staticClass:"sm-item-value title-item-value"},[s("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.selectedTitle,callback:function(t){e.selectedTitle=t},expression:"selectedTitle"}})],1)]),s("div",{staticClass:"lg-item"},[s("div",{staticClass:"lg-item-key"},[s("span",[e._v("概要("+e._s(e.selectedSummaryCount)+"/45)")]),s("el-popover",{attrs:{placement:"bottom",title:e.SUMMARY_SMS_LIMIT.TITLE,width:"400",trigger:"click",content:e.SUMMARY_SMS_LIMIT.CONTENT}},[s("el-badge",{staticClass:"help-badge",attrs:{slot:"reference",type:"warning",value:"?"},slot:"reference"})],1)],1),s("div",{staticClass:"sm-item-auto-value summary-item-value"},[s("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入概要"},model:{value:e.selectedSummary,callback:function(t){e.selectedSummary=t},expression:"selectedSummary"}})],1)]),s("div",{staticClass:"lg-item"},[s("div",{staticClass:"lg-item-key"},[s("span",[e._v("内容")]),s("el-popover",{attrs:{placement:"bottom",title:e.MESSAGE_VARIABLE_USAGE.TITLE,width:"400",trigger:"click",content:e.MESSAGE_VARIABLE_USAGE.CONTENT}},[s("el-badge",{staticClass:"help-badge",attrs:{slot:"reference",type:"warning",value:"?"},slot:"reference"})],1)],1),s("div",{staticClass:"sm-item-auto-value content-item-value"},[s("Editor",{attrs:{initText:e.initEditorContent},model:{value:e.editorContent,callback:function(t){e.editorContent=t},expression:"editorContent"}})],1)]),s("div",{staticClass:"sm-item"},[e._m(6),s("div",{staticClass:"sm-item-multi-value"},[s("el-button",{staticClass:"sm-item-multi-inner-button",attrs:{type:"primary"},on:{click:e.submitMessage}},[e._v("提交")]),s("el-button",{staticClass:"sm-item-multi-inner-button",on:{click:e.previewTemplate}},[e._v("预览")]),s("el-button",{staticClass:"sm-item-multi-inner-button",on:{click:e.saveAsTemplate}},[e._v("保存为模板")])],1)]),s("d-message-preview",{attrs:{isShow:e.isShowPreviewDialog,messageContent:e.selectedMessageContent},on:{close:e.closePreview}}),s("d-confirm-message",{attrs:{isShow:e.isShowSendingConfirmDialog,companyOptions:e.companyOptions,groupOptions:e.groupOptions,selectedChannelList:e.selectedChannelList,selectedCompanyList:e.selectedCompanyList,selectedGroupList:e.selectedGroupList,selectedRoleList:e.selectedRoleList,selectedType:e.selectedType,selectedLevel:e.selectedLevel,selectedTitle:e.selectedTitle,selectedSummary:e.selectedSummary,editorContent:e.editorContent},on:{confirm:e.confirmSending,close:e.cancelSending}})],1)},y=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("模板")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("发送途径")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"lg-item-key"},[s("span",[e._v("接收对象")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("通知类型")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("通知等级")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("标题")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span")])}],_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{ref:"editor",staticStyle:{"text-align":"left"}})])},C=[],E=s("1a0b"),L=s.n(E),M={name:"editor",props:["value","initText","preview"],data:function(){return{editorContent:"",editor:null}},methods:{getContent:function(){alert(this.value)}},watch:{initText:function(){this.editor.txt.html(this.initText)}},mounted:function(){var e=this;this.editor=new L.a(this.$refs.editor);this.editor.customConfig.onchange=function(t){e.editorContent=t,e.$emit("input",t)},this.preview?this.editor.customConfig.menus=[]:this.editor.customConfig.menus=["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","image","table","undo","redo"],this.editor.customConfig.uploadImgShowBase64=!0,this.editor.customConfig.zIndex=10,this.editor.create(),this.editor.txt.html(this.value),this.preview?this.editor.$textElem.attr("contenteditable",!1):this.editor.$textElem.attr("contenteditable",!0)}},S=M,T=Object(n["a"])(S,_,C,!1,null,"1547477e",null),b=T.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isShow?s("div",{staticClass:"dialog-bg dialog-z-order"},[s("div",{staticClass:"dialog-container"},[s("div",{staticClass:"dialog-content"},[s("div",{staticClass:"sm-item"},[e._m(0),s("div",{staticClass:"item-value"},[s("span",[e._v(e._s(e.messageContent.title))])])]),s("div",{staticClass:"lg-item"},[e._m(1),s("div",{staticClass:"item-value"},[e._v("\n          "+e._s(e.messageContent.summary)+"\n        ")])]),s("div",{staticClass:"lg-item"},[e._m(2),s("div",{staticClass:"item-value"},[s("Editor",{attrs:{preview:!0},model:{value:e.editorContent,callback:function(t){e.editorContent=t},expression:"editorContent"}})],1)]),s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.close}},[e._v("确定")])],1)])]):e._e()},A=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item-key"},[s("span",[e._v("标题")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item-key"},[s("span",[e._v("概要")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item-key"},[s("span",[e._v("内容")])])}],N=(s("4be7"),{props:["isShow","messageContent"],components:{Editor:b},data:function(){return{editorContent:null}},watch:{isShow:function(){this.isShow&&(this.editorContent=this.messageContent.content)}},methods:{close:function(){this.$emit("close")}}}),I=N,w=(s("ff13"),Object(n["a"])(I,k,A,!1,null,null,null)),R=w.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isShow?i("div",{staticClass:"dialog-bg dialog-z-order"},[i("div",{staticClass:"dialog-container"},[i("div",{staticClass:"dialog-header"},[i("div",{staticClass:"dialog-title"},[e._v("消息发送确认")]),i("div",{staticClass:"dialog-close"},[i("a",{attrs:{href:"#"},on:{click:e.close}},[i("img",{attrs:{src:s("6cef")}})])])]),i("div",{staticClass:"dialog-content"},[i("div",{staticClass:"sm-item"},[i("div",{staticClass:"sm-item-key"},[i("el-checkbox",{model:{value:e.checkChannel,callback:function(t){e.checkChannel=t},expression:"checkChannel"}}),i("span",[e._v("发送途径")])],1),i("div",{staticClass:"sm-item-value long-item-value"},[i("el-checkbox-group",{attrs:{disabled:""},model:{value:e.selectedChannelList,callback:function(t){e.selectedChannelList=t},expression:"selectedChannelList"}},[i("el-checkbox",{attrs:{label:"4"}},[e._v("客户端消息")]),i("el-checkbox",{attrs:{label:"1"}},[e._v("电子邮件")]),i("el-checkbox",{attrs:{label:"2"}},[e._v("手机短信")])],1)],1)]),i("div",{staticClass:"lg-item"},[i("div",{staticClass:"lg-item-key"},[i("el-checkbox",{model:{value:e.checkReceiver,callback:function(t){e.checkReceiver=t},expression:"checkReceiver"}}),i("span",[e._v("接收对象")])],1),i("div",{staticClass:"lg-item-multi-line-value receiver-item-value"},[i("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",disabled:"",placeholder:"所有公司"},model:{value:e.selectedCompanyList,callback:function(t){e.selectedCompanyList=t},expression:"selectedCompanyList"}},e._l(e.companyOptions,function(e){return i("el-option",{key:e.companyId,attrs:{label:e.companyCode,value:e.companyId}})}),1),i("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",disabled:"",placeholder:"所有管机组"},model:{value:e.selectedGroupList,callback:function(t){e.selectedGroupList=t},expression:"selectedGroupList"}},e._l(e.groupOptions,function(e){return i("el-option",{key:e.groupId,attrs:{label:e.groupName,value:e.groupId}})}),1),i("div",{staticClass:"lg-item-multi-line-value receiver-item-value"},[i("el-checkbox-group",{attrs:{disabled:""},model:{value:e.selectedRoleList,callback:function(t){e.selectedRoleList=t},expression:"selectedRoleList"}},[i("el-checkbox",{attrs:{label:"1"}},[e._v("交易员")]),i("el-checkbox",{attrs:{label:"2"}},[e._v("管理员")])],1)],1)],1)]),i("div",{staticClass:"sm-item"},[i("div",{staticClass:"sm-item-key"},[i("el-checkbox",{model:{value:e.checkType,callback:function(t){e.checkType=t},expression:"checkType"}}),i("span",[e._v("通知类型")])],1),i("div",{staticClass:"sm-item-value"},[i("el-select",{staticClass:"sm-item-value",attrs:{filterable:"",disabled:"",placeholder:"请选择通知类型"},model:{value:e.selectedType,callback:function(t){e.selectedType=t},expression:"selectedType"}},e._l(e.M_TYPE,function(e){return i("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1)],1)]),i("div",{staticClass:"sm-item"},[i("div",{staticClass:"sm-item-key"},[i("el-checkbox",{model:{value:e.checkLevel,callback:function(t){e.checkLevel=t},expression:"checkLevel"}}),i("span",[e._v("通知等级")])],1),i("div",{staticClass:"sm-item-value"},[i("el-select",{staticClass:"sm-item-value",attrs:{filterable:"",disabled:"",placeholder:"请选择通知等级"},model:{value:e.selectedLevel,callback:function(t){e.selectedLevel=t},expression:"selectedLevel"}},e._l(e.M_LEVEL,function(e){return i("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1)],1)]),i("div",{staticClass:"sm-item"},[i("div",{staticClass:"sm-item-key"},[i("el-checkbox",{model:{value:e.checkTitle,callback:function(t){e.checkTitle=t},expression:"checkTitle"}}),i("span",[e._v("标题")])],1),i("div",{staticClass:"sm-item-value title-item-value"},[i("el-input",{attrs:{disabled:"",placeholder:"请输入标题"},model:{value:e.selectedTitle,callback:function(t){e.selectedTitle=t},expression:"selectedTitle"}})],1)]),i("div",{staticClass:"lg-item"},[i("div",{staticClass:"lg-item-key"},[i("el-checkbox",{model:{value:e.checkSummary,callback:function(t){e.checkSummary=t},expression:"checkSummary"}}),i("span",[e._v("概要")])],1),i("div",{staticClass:"sm-item-auto-value summary-item-value"},[i("el-input",{attrs:{type:"textarea",rows:"3",disabled:"",placeholder:"请输入概要"},model:{value:e.selectedSummary,callback:function(t){e.selectedSummary=t},expression:"selectedSummary"}})],1)]),i("div",{staticClass:"lg-item"},[i("div",{staticClass:"lg-item-key"},[i("el-checkbox",{model:{value:e.checkContent,callback:function(t){e.checkContent=t},expression:"checkContent"}}),i("span",[e._v("内容")])],1),i("div",{staticClass:"sm-item-auto-value content-item-value"},[i("Editor",{attrs:{preview:!0},model:{value:e.editorContent,callback:function(t){e.editorContent=t},expression:"editorContent"}})],1)]),i("el-button",{staticClass:"dialog-small-button",attrs:{type:"primary",size:"medium"},on:{click:e.confirm}},[e._v("发送")]),i("el-button",{staticClass:"dialog-small-button",attrs:{size:"medium"},on:{click:e.close}},[e._v("取消")])],1)])]):e._e()},P=[],x={props:["isShow","companyOptions","groupOptions","selectedChannelList","selectedCompanyList","selectedGroupList","selectedRoleList","selectedType","selectedLevel","selectedTitle","selectedSummary","editorContent"],components:{Editor:b},data:function(){return{M_TYPE:this.$config.ENUM.M_TYPE.ITEMS,M_LEVEL:this.$config.ENUM.M_LEVEL.ITEMS,HOSTING_USER_ROLE:this.$config.ENUM.HOSTING_USER_ROLE.ITEMS,M_LEVEL_MAP:this.$config.ENUM.M_LEVEL.MAP,checkChannel:!1,checkReceiver:!1,checkType:!1,checkLevel:!1,checkTitle:!1,checkSummary:!1,checkContent:!1}},watch:{isShow:function(){this.isShow&&(this.checkChannel=!1,this.checkReceiver=!1,this.checkType=!1,this.checkLevel=!1,this.checkTitle=!1,this.checkSummary=!1,this.checkContent=!1)}},methods:{close:function(){this.$emit("close")},confirm:function(){this.check()||this.addMBMessage()},check:function(){return this.checkChannel?this.checkReceiver?this.checkType?this.checkLevel?this.checkTitle?this.checkSummary?this.checkContent?void 0:(alert("请确认内容无误后，在内容前打勾"),1):(alert("请确认概要无误后，在概要前打勾"),1):(alert("请确认标题无误后，在标题前打勾"),1):(alert("请确认通知等级无误后，在通知等级项前打勾"),1):(alert("请确认通知类型无误后，在通知类型项前打勾"),1):(alert("请确认接收对象无误后，在接收对象项前打勾"),1):(alert("请确认发送途径无误后，在发送途径项前打勾"),1)},checkParams:function(){return!this.selectedChannelList||this.selectedChannelList.length<1?(alert("请选择发送途径"),1):this.selectedTitle?this.selectedSummary?this.editorContent?0:(alert("请输入消息内容"),1):(alert("请输入消息概要"),1):(alert("请输入消息标题"),1)},addMBMessage:function(){if(!this.checkParams()){var e=this,t=new MBMessage;t.policy=MSendingPolicy.MSP_NOW,t.channelList=this.selectedChannelList,t.hostingList=this.$util.getMReceiverHostingList(this.selectedCompanyList,this.selectedGroupList,this.selectedRoleList),t.content=this.getMessageContent(),t.operator=this.$cookie.getCookie("oa_user_name");e=this;this.$api.addMBMessage(t,function(t){null!=t?t.success?(alert("消息提交成功"),e.$emit("confirm")):t.message?alert(t.message):t.errorMsg?alert(t.errorMsg):alert(e.$string.message.callMethodFail):alert(e.$string.message.serverBusy)})}},getMessageContent:function(){var e=new MessageContent;return e.type=MType[this.selectedType],e.level=MLevel[this.selectedLevel],e.title=this.selectedTitle,e.summary=this.selectedSummary,e.content=this.$util.genHTMLContent(this.editorContent),e}}},U=x,K=(s("be5d"),Object(n["a"])(U,O,P,!1,null,null,null)),G=K.exports,B={name:"home",components:{Editor:b,"d-message-preview":R,"d-confirm-message":G},data:function(){return{M_TYPE:this.$config.ENUM.M_TYPE.ITEMS,M_LEVEL:this.$config.ENUM.M_LEVEL.ITEMS,HOSTING_USER_ROLE:this.$config.ENUM.HOSTING_USER_ROLE.ITEMS,M_LEVEL_MAP:this.$config.ENUM.M_LEVEL.MAP,SUMMARY_SMS_LIMIT:this.$config.HELP.SUMMARY_SMS_LIMIT,MESSAGE_VARIABLE_USAGE:this.$config.HELP.MESSAGE_VARIABLE_USAGE,templateOptions:[],companyOptions:[],groupOptions:[],queryTemplateId:null,queryTemplateName:null,selectedTemplate:null,selectedTemplateOption:null,selectedCompanyList:[],selectedGroupList:[],selectedRoleList:this.$config.ENUM.HOSTING_USER_ROLE.VALUES,selectedType:this.$config.ENUM.M_TYPE.ITEMS[0].KEY,selectedLevel:this.$config.ENUM.M_LEVEL.ITEMS[0].KEY,selectedTitle:null,selectedSummary:null,selectedSummaryCount:0,selectedChannelList:[],initEditorContent:"",editorContent:"",disableGroupSelector:!0,isShowPreviewDialog:!1,selectedMessageContent:null,isShowSendingConfirmDialog:!1}},mounted:function(){this.selectedChannelList=["4"],this.$util.resetNavigationStack(),this.$util.pushNavigationStack({name:"通知运行管理 发送通知",router:{path:"/sending"}}),this.getQueryParams(),this.initQuery()},watch:{selectedSummary:function(){this.selectedSummaryCount=this.selectedSummary.length}},methods:{initQuery:function(){this.reqMBMessageTemplateSelector(),this.reqCompanyReceiver()},getQueryParams:function(){this.queryTemplateId=this.$route.query.templateId,this.queryTemplateName=this.$route.query.templateName,this.queryTemplateId&&this.queryTemplateName&&(this.selectedTemplateOption=this.queryTemplateName,this.reqTemplate(this.queryTemplateId))},reqMBMessageTemplateSelector:function(){var e=this;this.$api.reqMBMessageTemplateSelector(function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||t.length<1)return void(e.templateOptions=[]);e.templateOptions=t}})},reqCompanyReceiver:function(){var e=this;this.$api.reqCompanyReceiver(function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||t.length<1)return void(e.companyOptions=[]);e.companyOptions=t}})},reqGroupReceiver:function(e){var t=this;this.$apiUtil.reqGroupReceiver(e,function(e){t.groupOptions=e})},onTemplateOptionChange:function(){this.selectedTemplateOption&&this.selectedTemplateOption>0&&this.reqTemplate(this.selectedTemplateOption)},reqTemplate:function(e){var t=this,s=new QueryMBMessageTemplateOption;s.templateIdSet=[],s.templateIdSet.push(e);var i=new IndexedPageOption;i.needTotalCount=!1,i.pageIndex=0,i.pageSize=1,this.$api.reqTemplate(s,i,function(e){if(null!=e&&e.errorMsg)alert(e.errorMsg);else{if(!e||!e.templateList||e.templateList.length<1)return void(t.selectedTemplate=null);t.selectedTemplate=e.templateList[0],t.applyTemplate()}})},applyTemplate:function(){if(this.selectedTemplate){this.selectedChannelList=this.$util.getStringChannelList(this.selectedTemplate.channelList),this.selectedCompanyList=this.$util.getCompanyListFromHostingList(this.selectedTemplate.hostingList),this.selectedCompanyList&&1==this.selectedCompanyList.length?(this.reqGroupReceiver(this.selectedCompanyList[0]),this.disableGroupSelector=!1):this.disableGroupSelector=!0,this.selectedGroupList=this.$util.getGroupListFromHostingList(this.selectedTemplate.hostingList),this.selectedRoleList=this.$util.getRoleListFromHostingList(this.selectedTemplate.hostingList),this.selectedType=this.M_TYPE[this.selectedTemplate.content.type].KEY,this.selectedLevel=this.M_LEVEL_MAP[this.selectedTemplate.content.level].KEY,this.selectedTitle=this.selectedTemplate.content.title,this.selectedSummary=this.selectedTemplate.content.summary,this.selectedSummary&&(this.selectedSummaryCount=this.selectedSummary.length);var e=this;this.$util.getRTFContent(this.selectedTemplate.content.content,function(t){e.initEditorContent=t,e.editorContent=t})}},clear:function(){this.groupOptions=[],this.selectedTemplateOption=null,this.selectedTemplate=null,this.selectedCompanyList=[],this.selectedGroupList=[],this.selectedRoleList=this.$config.ENUM.HOSTING_USER_ROLE.VALUES,this.selectedType=this.$config.ENUM.M_TYPE.ITEMS[0].KEY,this.selectedLevel=this.$config.ENUM.M_LEVEL.ITEMS[0].KEY,this.selectedTitle=null,this.selectedSummary=null,this.selectedChannelList=["4"],this.editorContent="",this.disableGroupSelector=!0},onCompanyOptionsChange:function(){var e=this;this.$util.checkCompany(this.selectedCompanyList,function(t){1==e.selectedCompanyList.length&&t&&t.length>0?(e.groupOptions=t,e.disableGroupSelector=!1):1!=e.selectedCompanyList.length&&(e.groupOptions=[],e.selectedGroupList=[],e.disableGroupSelector=!0)})},checkParams:function(){return!this.selectedChannelList||this.selectedChannelList.length<1?(alert("请选择发送途径"),1):this.selectedTitle?this.selectedTitle&&this.selectedTitle.length>32?(alert("标题字数过长，请重新填写"),1):this.selectedSummary?this.selectedSummary&&this.selectedSummary.length>128?(alert("概要字数过长，请重新填写"),1):this.editorContent?0:(alert("请输入消息内容"),1):(alert("请输入消息概要"),1):(alert("请输入消息标题"),1)},getMessageContent:function(){var e=new MessageContent;return e.type=MType[this.selectedType],e.level=MLevel[this.selectedLevel],e.title=this.selectedTitle,e.summary=this.selectedSummary,e.content=this.editorContent,e},submitMessage:function(){this.checkParams()||this.showSendingConfirmDialog()},saveAsTemplate:function(){if(confirm("确定要将该通知保存为模板吗？")){var e=prompt("请输入模板名");if(e){var t=this,s=new MBMessageTemplate;s.templateName=e,s.policy=MSendingPolicy.MSP_NOW,this.selectedChannelList&&this.selectedChannelList.length>0&&(s.channelList=this.selectedChannelList),s.hostingList=this.$util.getMReceiverHostingList(this.selectedCompanyList,this.selectedGroupList,this.selectedRoleList),s.content=this.getMessageContent(),this.$api.addTemplate(s,function(e){null!=e?e.success?(alert("模板添加成功"),t.reqMBMessageTemplateSelector()):e.message?alert(e.message):e.errorMsg?alert(e.errorMsg):alert(t.$string.message.callMethodFail):alert(t.$string.message.serverBusy)})}else alert("模板名不能为空")}},previewTemplate:function(e){this.selectedMessageContent={title:this.selectedTitle,summary:this.selectedSummary,content:this.editorContent},this.isShowPreviewDialog=!0},closePreview:function(){this.isShowPreviewDialog=!1},gotoSentMessagePage:function(){this.$router.push("/sent")},showSendingConfirmDialog:function(){this.isShowSendingConfirmDialog=!0},confirmSending:function(){this.isShowSendingConfirmDialog=!1,this.clear(),this.gotoSentMessagePage()},cancelSending:function(){this.isShowSendingConfirmDialog=!1}}},q=B,Y=(s("0df9"),Object(n["a"])(q,f,y,!1,null,"6f35a94c",null)),V=Y.exports,D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"body"},[s("div",{staticClass:"body-header"},[s("div",{staticClass:"body-header-left"},[s("span",[e._v("发送时间：")]),s("div",{staticClass:"date-picker-left"},[s("el-date-picker",{staticClass:"date-picker-left",attrs:{type:"date","value-format":"timestamp",placeholder:"开始日期"},model:{value:e.searchKeyStartCreateTime,callback:function(t){e.searchKeyStartCreateTime=t},expression:"searchKeyStartCreateTime"}})],1),s("span",[e._v("至")]),s("div",{staticClass:"date-picker-right body-header-component"},[s("el-date-picker",{attrs:{type:"date","value-format":"timestamp",placeholder:"结束日期"},model:{value:e.searchKeyEndCreateTime,callback:function(t){e.searchKeyEndCreateTime=t},expression:"searchKeyEndCreateTime"}})],1),s("span",[e._v("发送途径：")]),s("el-select",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"发送途径",clearable:""},model:{value:e.searchKeyChannel,callback:function(t){e.searchKeyChannel=t},expression:"searchKeyChannel"}},e._l(e.M_SENDING_CHANNEL,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1),s("span",[e._v("通知类型：")]),s("el-select",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"通知类型",clearable:""},model:{value:e.searchKeyType,callback:function(t){e.searchKeyType=t},expression:"searchKeyType"}},e._l(e.M_TYPE,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1),s("span",[e._v("通知级别：")]),s("el-select",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"通知级别",clearable:""},model:{value:e.searchKeyLevel,callback:function(t){e.searchKeyLevel=t},expression:"searchKeyLevel"}},e._l(e.M_LEVEL,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1),s("el-button",{staticClass:"body-header-component",attrs:{type:"primary",size:"small"},on:{click:e.query}},[e._v("查询")])],1),s("div",{staticClass:"body-header-right"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.query}},[e._v("刷新")])],1)]),s("div",{staticClass:"body-content"},[s("table",[e._m(0),e._l(e.messageJobList,function(t,i){return s("tr",{key:i},[s("td",[e._v(e._s(e.convertTimestampToString(t.createTimestamp)))]),s("td",e._l(t.channelList,function(t){return s("span",{key:t.VALUE,staticClass:"td-item"},[e._v(e._s(e.M_SENDING_CHANNEL_MAP[t].LABEL))])}),0),s("td",[t.content?s("span",[e._v(e._s(e.M_TYPE[t.content.type].LABEL))]):s("span",[e._v("--")])]),s("td",[t.content?s("span",[e._v(e._s(e.M_LEVEL_MAP[t.content.level].LABEL))]):s("span",[e._v("--")])]),s("td",[t.content?s("span",[e._v(e._s(t.content.title))]):s("span",[e._v("--")])]),s("td",[t.operator?s("span",[e._v(e._s(t.operator))]):s("span",[e._v("--")])]),s("td",[s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.showReceiverInfoDialog(t)}}},[e._v("接收对象")]),s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.showMessage(t.content)}}},[e._v("消息内容")])])])})],2),e.nodata?s("div",{staticClass:"body-content-nodata"},[e._v("无数据")]):e._e()]),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.totalNum,"page-size":e.pageSize,"current-page":e.currentPage},on:{"size-change":e.handleSizeChange,"current-change":e.onPageChange}})],1)]),s("d-message-preview",{attrs:{isShow:e.isShowMessageDialog,messageContent:e.selectedMessageContent},on:{close:e.closePreview}}),s("d-receiver-info",{attrs:{isShow:e.isShowReceiverInfoDialog,title:e.selectedTitle,message:e.selectedJob,companyOptions:e.companyOptions},on:{close:e.closeReceiverInfoDialog}})],1)},H=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",{attrs:{bgColor:"#F8FCFF"}},[s("th",{attrs:{width:"300"}},[e._v("发送时间")]),s("th",{attrs:{width:"300"}},[e._v("发送方式")]),s("th",{attrs:{width:"150"}},[e._v("通知类型")]),s("th",{attrs:{width:"150"}},[e._v("通知等级")]),s("th",{attrs:{width:"400"}},[e._v("标题")]),s("th",{attrs:{width:"200"}},[e._v("操作者")]),s("th",{attrs:{width:"300"}},[e._v("操作")])])}],J=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isShow?i("div",{staticClass:"dialog-bg"},[i("div",{staticClass:"dialog-container"},[i("div",{staticClass:"dialog-header"},[i("div",{staticClass:"dialog-title"},[e._v(e._s(e.title))]),i("div",{staticClass:"dialog-close"},[i("a",{attrs:{href:"#"},on:{click:e.close}},[i("img",{attrs:{src:s("6cef")}})])])]),i("div",{staticClass:"dialog-content custom-dialog"},[i("div",{staticClass:"lg-item"},[e._m(0),i("div",{staticClass:"lg-item-multi-line-value"},[i("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",disabled:!0,placeholder:"所有公司"},model:{value:e.companyList,callback:function(t){e.companyList=t},expression:"companyList"}},e._l(e.companyOptions,function(e){return i("el-option",{key:e.companyId,attrs:{label:e.companyCode,value:e.companyId}})}),1),i("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",disabled:!0,placeholder:"所有管机组"},model:{value:e.groupList,callback:function(t){e.groupList=t},expression:"groupList"}},e._l(e.groupOptions,function(e){return i("el-option",{key:e.groupId,attrs:{label:e.groupName,value:e.groupId}})}),1),i("div",{staticClass:"lg-item-multi-line-value receiver-item-value"},[i("el-checkbox-group",{model:{value:e.roleList,callback:function(t){e.roleList=t},expression:"roleList"}},[i("el-checkbox",{attrs:{label:"1",disabled:""}},[e._v("交易员")]),i("el-checkbox",{attrs:{label:"2",disabled:""}},[e._v("管理员")])],1)],1)],1)])]),i("div",{staticClass:"dialog-button-container"},[i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.close}},[e._v("确定")])],1)])]):e._e()},F=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"lg-item-key"},[s("span",[e._v("接收对象")])])}],z={props:["isShow","title","message","companyOptions"],data:function(){return{groupOptions:[],disableGroupSelector:!0,companyList:[],groupList:[],roleList:[]}},mounted:function(){},watch:{isShow:function(){this.isShow&&this.init()}},methods:{close:function(){this.$emit("close")},init:function(){this.companyList=this.$util.getCompanyListFromHostingList(this.message.hostingList),this.companyList&&1==this.companyList.length?(this.reqGroupReceiver(this.companyList[0]),this.disableGroupSelector=!1):this.disableGroupSelector=!0,this.groupList=this.$util.getGroupListFromHostingList(this.message.hostingList),this.roleList=this.$util.getRoleListFromHostingList(this.message.hostingList)},checkParams:function(){return this.maintenance?0:(alert("页面过期，请刷新后再尝试"),1)},reqGroupReceiver:function(e){var t=this;this.$api.reqGroupReceiver(e,function(e){if(null!=e&&e.errorMsg)alert(e.errorMsg);else{if(null==e||e.length<1)return void(t.groupOptions=[]);t.groupOptions=e}})}}},j=z,Q=(s("b2f2"),Object(n["a"])(j,J,F,!1,null,"0c6b6615",null)),X=Q.exports,W={name:"home",components:{"d-message-preview":R,"d-receiver-info":X},data:function(){return{M_SENDING_CHANNEL:this.$config.ENUM.M_SENDING_CHANNEL.ITEMS,M_TYPE:this.$config.ENUM.M_TYPE.ITEMS,M_LEVEL:this.$config.ENUM.M_LEVEL.ITEMS,M_SENDING_CHANNEL_MAP:this.$config.ENUM.M_SENDING_CHANNEL.MAP,M_LEVEL_MAP:this.$config.ENUM.M_LEVEL.MAP,searchKeyStartCreateTime:null,searchKeyEndCreateTime:null,searchKeyChannel:null,searchKeyType:null,searchKeyLevel:null,totalNum:0,currentPage:1,pageSize:10,nodata:!0,messageJobList:[],isShowMessageDialog:!1,selectedMessageContent:null,isShowReceiverInfoDialog:!1,selectedJob:null,selectedTitle:null,companyOptions:[]}},mounted:function(){this.$util.resetNavigationStack(),this.$util.pushNavigationStack({name:"通知运行管理 已发送",router:{path:"/sent"}}),this.reqMBMessageJob(),this.reqCompanyReceiver()},methods:{onPageChange:function(e){this.currentPage=e,this.reqMBMessageJob()},handleSizeChange:function(e){this.pageSize=e,this.reqMBMessageJob()},reqCompanyReceiver:function(){var e=this;this.$api.reqCompanyReceiver(function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||t.length<1)return void(e.companyOptions=[]);e.companyOptions=t}})},query:function(){this.reqMBMessageJob()},reqMBMessageJob:function(){var e=this,t=new QueryMBMessageJobOption;this.searchKeyStartCreateTime&&(t.queryStartCreateTimestamp=this.searchKeyStartCreateTime/1e3),this.searchKeyEndCreateTime&&(t.queryEndCreateTimestamp=this.searchKeyEndCreateTime/1e3),this.searchKeyChannel&&(t.channel=MSendingChannel[this.searchKeyChannel]),null!=this.searchKeyType&&void 0!=this.searchKeyType&&(t.type=MType[this.searchKeyType]),null!=this.searchKeyLevel&&void 0!=this.searchKeyLevel&&(t.level=MLevel[this.searchKeyLevel]),t.statusSet=[],t.statusSet.push(MJStatus.MJS_COMPLETED);var s=new IndexedPageOption;s.needTotalCount=!0,s.pageIndex=this.currentPage-1,s.pageSize=this.pageSize,this.$api.reqMBMessageJob(t,s,function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||null==t.messageJobList||t.messageJobList.length<1)return e.messageJobList=[],e.totalNum=0,void(e.nodata=!0);e.messageJobList=t.messageJobList,e.totalNum=t.totalNum,e.nodata=!1}})},showMessage:function(e){var t=this;this.$util.getRTFContent(e.content,function(s){t.selectedMessageContent={title:e.title,summary:e.summary,content:s},t.isShowMessageDialog=!0})},closePreview:function(){this.isShowMessageDialog=!1},showReceiverInfoDialog:function(e){this.companyOptions?(this.selectedTitle=e.content.title,this.selectedJob=e,this.isShowReceiverInfoDialog=!0):alert("页面过期，请尝试刷新后重试")},closeReceiverInfoDialog:function(){this.isShowReceiverInfoDialog=!1},convertTimestampToString:function(e){return this.$timeUtil.getYYYY_MM_DD_HH_MM_SS(1e3*e)}}},Z=W,ee=(s("68f3"),Object(n["a"])(Z,D,H,!1,null,"59b7dab2",null)),te=ee.exports,se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"body"},[s("div",{staticClass:"body-header"},[s("div",{staticClass:"body-header-left"},[s("span",[e._v("发送时间：")]),s("div",{staticClass:"date-picker-left"},[s("el-date-picker",{staticClass:"date-picker-left",attrs:{type:"date","value-format":"timestamp",placeholder:"开始日期"},model:{value:e.searchKeyStartCreateTime,callback:function(t){e.searchKeyStartCreateTime=t},expression:"searchKeyStartCreateTime"}})],1),s("span",[e._v("至")]),s("div",{staticClass:"date-picker-right body-header-component"},[s("el-date-picker",{attrs:{type:"date","value-format":"timestamp",placeholder:"结束日期"},model:{value:e.searchKeyEndCreateTime,callback:function(t){e.searchKeyEndCreateTime=t},expression:"searchKeyEndCreateTime"}})],1),s("span",[e._v("发送途径：")]),s("el-select",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"发送途径",clearable:""},model:{value:e.searchKeyChannel,callback:function(t){e.searchKeyChannel=t},expression:"searchKeyChannel"}},e._l(e.M_SENDING_CHANNEL,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1),s("span",[e._v("通知类型：")]),s("el-select",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"通知类型",clearable:""},model:{value:e.searchKeyType,callback:function(t){e.searchKeyType=t},expression:"searchKeyType"}},e._l(e.M_TYPE,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1),s("span",[e._v("通知级别：")]),s("el-select",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"通知级别",clearable:""},model:{value:e.searchKeyLevel,callback:function(t){e.searchKeyLevel=t},expression:"searchKeyLevel"}},e._l(e.M_LEVEL,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1),s("el-button",{staticClass:"body-header-component",attrs:{type:"primary",size:"small"},on:{click:e.query}},[e._v("查询")])],1),s("div",{staticClass:"body-header-right"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.query}},[e._v("刷新")])],1)]),s("div",{staticClass:"body-content"},[s("table",[e._m(0),e._l(e.messageJobList,function(t,i){return s("tr",{key:i},[s("td",[e._v(e._s(e.convertTimestampToString(t.createTimestamp)))]),s("td",e._l(t.channelList,function(t){return s("span",{key:t.VALUE,staticClass:"td-item"},[e._v(e._s(e.M_SENDING_CHANNEL_MAP[t].LABEL))])}),0),s("td",[t.content?s("span",[e._v(e._s(e.M_TYPE[t.content.type].LABEL))]):s("span",[e._v("--")])]),s("td",[t.content?s("span",[e._v(e._s(e.M_LEVEL_MAP[t.content.level].LABEL))]):s("span",[e._v("--")])]),s("td",[t.content?s("span",[e._v(e._s(t.content.title))]):s("span",[e._v("--")])]),s("td",[s("span",[e._v(e._s(e.M_JOB_STATUS[t.status].LABEL))])]),s("td",[e._v(e._s(t.errorDescription))]),s("td",[t.operator?s("span",[e._v(e._s(t.operator))]):s("span",[e._v("--")])]),s("td",[s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.showReceiverInfoDialog(t)}}},[e._v("接收对象")]),s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.showMessage(t.content)}}},[e._v("消息内容")]),e.isResendable(t)?s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.showResendDialog(t)}}},[e._v("重发")]):e._e()])])})],2),e.nodata?s("div",{staticClass:"body-content-nodata"},[e._v("无数据")]):e._e()]),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.totalNum,"page-size":e.pageSize,"current-page":e.currentPage},on:{"size-change":e.handleSizeChange,"current-change":e.onPageChange}})],1)]),s("d-message-preview",{attrs:{isShow:e.isShowMessageDialog,messageContent:e.selectedMessageContent},on:{close:e.closePreview}}),s("d-receiver-info",{attrs:{isShow:e.isShowReceiverInfoDialog,title:e.selectedTitle,message:e.selectedJob,companyOptions:e.companyOptions},on:{close:e.closeReceiverInfoDialog}})],1)},ie=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",{attrs:{bgColor:"#F8FCFF"}},[s("th",{attrs:{width:"200"}},[e._v("发送时间")]),s("th",{attrs:{width:"300"}},[e._v("发送方式")]),s("th",{attrs:{width:"150"}},[e._v("通知类型")]),s("th",{attrs:{width:"150"}},[e._v("通知等级")]),s("th",{attrs:{width:"300"}},[e._v("标题")]),s("th",{attrs:{width:"150"}},[e._v("状态")]),s("th",{attrs:{width:"400"}},[e._v("错误描述")]),s("th",{attrs:{width:"200"}},[e._v("操作者")]),s("th",{attrs:{width:"300"}},[e._v("操作")])])}],ae={name:"home",components:{"d-message-preview":R,"d-receiver-info":X},data:function(){return{M_SENDING_CHANNEL:this.$config.ENUM.M_SENDING_CHANNEL.ITEMS,M_TYPE:this.$config.ENUM.M_TYPE.ITEMS,M_LEVEL:this.$config.ENUM.M_LEVEL.ITEMS,M_SENDING_CHANNEL_MAP:this.$config.ENUM.M_SENDING_CHANNEL.MAP,M_LEVEL_MAP:this.$config.ENUM.M_LEVEL.MAP,M_JOB_STATUS:this.$config.ENUM.M_JOB_STATUS.ITEMS,searchKeyStartCreateTime:null,searchKeyEndCreateTime:null,searchKeyChannel:null,searchKeyType:null,searchKeyLevel:null,totalNum:0,currentPage:1,pageSize:10,nodata:!0,messageJobList:[],isShowMessageDialog:!1,selectedMessageContent:null,isShowReceiverInfoDialog:!1,selectedJob:null,selectedTitle:null,companyOptions:[]}},mounted:function(){this.$util.resetNavigationStack(),this.$util.pushNavigationStack({name:"通知运行管理 异常通知",router:{path:"/errorMessage"}}),this.reqMBMessageJob(),this.reqCompanyReceiver()},methods:{onPageChange:function(e){this.currentPage=e,this.reqMBMessageJob()},handleSizeChange:function(e){this.pageSize=e,this.reqMBMessageJob()},reqCompanyReceiver:function(){var e=this;this.$api.reqCompanyReceiver(function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||t.length<1)return void(e.companyOptions=[]);e.companyOptions=t}})},query:function(){this.reqMBMessageJob()},reqMBMessageJob:function(){var e=this,t=new QueryMBMessageJobOption;this.searchKeyStartCreateTime&&(t.queryStartCreateTimestamp=this.searchKeyStartCreateTime/1e3),this.searchKeyEndCreateTime&&(t.queryEndCreateTimestamp=this.searchKeyEndCreateTime/1e3),this.searchKeyChannel&&(t.channel=MSendingChannel[this.searchKeyChannel]),null!=this.searchKeyType&&void 0!=this.searchKeyType&&(t.type=MType[this.searchKeyType]),null!=this.searchKeyLevel&&void 0!=this.searchKeyLevel&&(t.level=MLevel[this.searchKeyLevel]),t.statusSet=[],t.statusSet.push(MJStatus.MJS_SENDING),t.statusSet.push(MJStatus.MJS_EXCEPTION_STOP),t.statusSet.push(MJStatus.MJS_NETWORK_ERROR_RETRY),t.statusSet.push(MJStatus.MJS_NETWORK_ERROR_STOP);var s=new IndexedPageOption;s.needTotalCount=!0,s.pageIndex=this.currentPage-1,s.pageSize=this.pageSize,this.$api.reqMBMessageJob(t,s,function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||null==t.messageJobList||t.messageJobList.length<1)return e.messageJobList=[],e.totalNum=0,void(e.nodata=!0);e.messageJobList=t.messageJobList,e.totalNum=t.totalNum,e.nodata=!1}})},showMessage:function(e){var t=this;this.$util.getRTFContent(e.content,function(s){t.selectedMessageContent={title:e.title,summary:e.summary,content:s},t.isShowMessageDialog=!0})},closePreview:function(){this.isShowMessageDialog=!1},showReceiverInfoDialog:function(e){this.companyOptions?(this.selectedTitle=e.content.title,this.selectedJob=e,this.isShowReceiverInfoDialog=!0):alert("页面过期，请尝试刷新后重试")},closeReceiverInfoDialog:function(){this.isShowReceiverInfoDialog=!1},showResendDialog:function(e){if(confirm("确认重发消息（"+e.content.title+")?")){var t=this;this.$api.updateMessageJobStatus(e.jobId,MJStatus.MJS_SENDING,function(e){null!=e?e.success?(alert("重发成功"),t.reqMBMessageJob()):e.message?alert(e.message):e.errorMsg?alert(e.errorMsg):alert(t.$string.message.callMethodFail):alert(t.$string.message.serverBusy)})}},isResendable:function(e){return e.status==MJStatus.MJS_EXCEPTION_STOP||e.status==MJStatus.MJS_NETWORK_ERROR_STOP},convertTimestampToString:function(e){return this.$timeUtil.getYYYY_MM_DD_HH_MM_SS(1e3*e)}}},le=ae,ne=(s("c02c"),Object(n["a"])(le,se,ie,!1,null,"9ad295fe",null)),oe=ne.exports,re=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"body"},[s("div",{staticClass:"body-header"},[s("div",{staticClass:"body-header-left"},[s("span",[e._v("模板名称：")]),s("el-input",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"模板名称",clearable:""},model:{value:e.searchKeyTemplateName,callback:function(t){e.searchKeyTemplateName=t},expression:"searchKeyTemplateName"}}),s("span",[e._v("发送途径：")]),s("el-select",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"发送途径",clearable:""},model:{value:e.searchKeyChannel,callback:function(t){e.searchKeyChannel=t},expression:"searchKeyChannel"}},e._l(e.M_SENDING_CHANNEL,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1),s("span",[e._v("通知类型：")]),s("el-select",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"通知类型",clearable:""},model:{value:e.searchKeyType,callback:function(t){e.searchKeyType=t},expression:"searchKeyType"}},e._l(e.M_TYPE,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1),s("span",[e._v("通知级别：")]),s("el-select",{staticClass:"body-header-input body-header-component",attrs:{placeholder:"通知级别",clearable:""},model:{value:e.searchKeyLevel,callback:function(t){e.searchKeyLevel=t},expression:"searchKeyLevel"}},e._l(e.M_LEVEL,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1),s("el-button",{staticClass:"body-header-component",attrs:{type:"primary",size:"small"},on:{click:e.query}},[e._v("查询")])],1),s("div",{staticClass:"body-header-right"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.gotoEditTempaltePage}},[e._v("新增模板")])],1)]),s("div",{staticClass:"body-content"},[s("table",[e._m(0),e._l(e.templateList,function(t,i){return s("tr",{key:i},[s("td",[e._v(e._s(t.templateName))]),s("td",[t.channelList&&t.channelList.length>0?s("div",e._l(t.channelList,function(t){return s("span",{key:t.VALUE,staticClass:"td-item"},[e._v(e._s(e.M_SENDING_CHANNEL_MAP[t].LABEL))])}),0):s("div",[s("span",[e._v("--")])])]),s("td",[t.content?s("span",[e._v(e._s(e.M_TYPE[t.content.type].LABEL))]):s("span",[e._v("--")])]),s("td",[t.content?s("span",[e._v(e._s(e.M_LEVEL_MAP[t.content.level].LABEL))]):s("span",[e._v("--")])]),s("td",[t.content?s("span",[e._v(e._s(t.content.title))]):s("span",[e._v("--")])]),s("td",[s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.showReceiverInfoDialog(t)}}},[e._v("接收对象")]),s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.previewTemplate(t)}}},[e._v("消息内容")]),s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.gotoEditTemplatePage(t)}}},[e._v("编辑")]),s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.applyTemplate(t)}}},[e._v("使用")]),s("a",{staticClass:"td-item",attrs:{href:"#"},on:{click:function(s){return e.deleteTemplate(t)}}},[e._v("删除")])])])})],2),e.nodata?s("div",{staticClass:"body-content-nodata"},[e._v("无数据")]):e._e()]),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.totalNum,"page-size":e.pageSize,"current-page":e.currentPage},on:{"size-change":e.handleSizeChange,"current-change":e.onPageChange}})],1)]),s("d-message-preview",{attrs:{isShow:e.isShowPreviewDialog,messageContent:e.selectedMessageContent},on:{close:e.closePreview}}),s("d-receiver-info",{attrs:{isShow:e.isShowReceiverInfoDialog,title:e.selectedTitle,message:e.selectedTemplate,companyOptions:e.companyOptions},on:{close:e.closeReceiverInfoDialog}})],1)},ce=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",{attrs:{bgColor:"#F8FCFF"}},[s("th",{attrs:{width:"300"}},[e._v("模板名称")]),s("th",{attrs:{width:"300"}},[e._v("发送方式")]),s("th",{attrs:{width:"200"}},[e._v("通知类型")]),s("th",{attrs:{width:"150"}},[e._v("通知等级")]),s("th",{attrs:{width:"400"}},[e._v("标题")]),s("th",{attrs:{width:"350"}},[e._v("操作")])])}],ue={name:"home",components:{"d-message-preview":R,"d-receiver-info":X},data:function(){return{M_SENDING_CHANNEL:this.$config.ENUM.M_SENDING_CHANNEL.ITEMS,M_TYPE:this.$config.ENUM.M_TYPE.ITEMS,M_LEVEL:this.$config.ENUM.M_LEVEL.ITEMS,M_LEVEL_MAP:this.$config.ENUM.M_LEVEL.MAP,M_SENDING_CHANNEL_MAP:this.$config.ENUM.M_SENDING_CHANNEL.MAP,searchKeyTemplateName:null,searchKeyChannel:null,searchKeyType:null,searchKeyLevel:null,totalNum:0,currentPage:1,pageSize:10,templateList:[],nodata:!0,isShowPreviewDialog:!1,selectedMessageContent:null,isShowReceiverInfoDialog:!1,selectedTemplate:null,selectedTitle:null,companyOptions:[]}},mounted:function(){this.$util.resetNavigationStack(),this.$util.pushNavigationStack({name:"通知运行管理 模板管理",router:{path:"/template"}}),this.reqTemplate(),this.reqCompanyReceiver()},methods:{onPageChange:function(e){this.currentPage=e,this.reqTemplate()},handleSizeChange:function(e){this.pageSize=e,this.reqTemplate()},gotoEditTempaltePage:function(){this.$router.push("/addTemplate")},reqCompanyReceiver:function(){var e=this;this.$api.reqCompanyReceiver(function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||t.length<1)return void(e.companyOptions=[]);e.companyOptions=t}})},query:function(){this.reqTemplate()},reqTemplate:function(){var e=this,t=new QueryMBMessageTemplateOption;this.searchKeyTemplateName&&(t.templateNamePartial=this.searchKeyTemplateName),this.searchKeyChannel&&(t.channel=MSendingChannel[this.searchKeyChannel]),null!=this.searchKeyType&&void 0!=this.searchKeyType&&(t.type=MType[this.searchKeyType]),null!=this.searchKeyLevel&&void 0!=this.searchKeyLevel&&(t.level=MLevel[this.searchKeyLevel]);var s=new IndexedPageOption;s.needTotalCount=!0,s.pageIndex=this.currentPage-1,s.pageSize=this.pageSize,this.$api.reqTemplate(t,s,function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||null==t.templateList||t.templateList.length<1)return e.templateList=[],e.totalNum=0,void(e.nodata=!0);e.templateList=t.templateList,e.totalNum=t.totalNum,e.nodata=!1}})},applyTemplate:function(e){this.$router.push({path:"/sending",query:{templateId:e.templateId,templateName:e.templateName}})},deleteTemplate:function(e){if(confirm("确定删除模板("+e.templateName+")?")){var t=this;this.$api.removeTemplate(e.templateId,function(e){null!=e?e.success?(alert("删除成功"),t.reqTemplate()):e.message?alert(e.message):e.errorMsg?alert(e.errorMsg):alert(t.$string.message.callMethodFail):alert(t.$string.message.serverBusy)})}},gotoEditTemplatePage:function(e){this.$router.push({path:"/editTemplate",query:{template:e}})},previewTemplate:function(e){var t=this;this.$util.getRTFContent(e.content.content,function(s){t.selectedMessageContent={title:e.content.title,summary:e.content.summary,content:s},t.isShowPreviewDialog=!0})},closePreview:function(){this.isShowPreviewDialog=!1},showReceiverInfoDialog:function(e){this.companyOptions?(this.selectedTitle=e.templateName,this.selectedTemplate=e,this.isShowReceiverInfoDialog=!0):alert("页面过期，请尝试刷新后重试")},closeReceiverInfoDialog:function(){this.isShowReceiverInfoDialog=!1}}},me=ue,de=(s("dfe0"),Object(n["a"])(me,re,ce,!1,null,"9f1d805c",null)),he=de.exports,pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"sm-item"},[e._m(0),s("div",{staticClass:"sm-item-value"},[s("el-input",{attrs:{placeholder:"请输入模板名"},model:{value:e.selectedTemplateName,callback:function(t){e.selectedTemplateName=t},expression:"selectedTemplateName"}})],1)]),s("div",{staticClass:"item-divider"}),s("div",{staticClass:"sm-item"},[e._m(1),s("div",{staticClass:"sm-item-value long-item-value"},[s("el-checkbox-group",{model:{value:e.selectedChannelList,callback:function(t){e.selectedChannelList=t},expression:"selectedChannelList"}},[s("el-checkbox",{attrs:{label:"4"}},[e._v("客户端消息")]),s("el-checkbox",{attrs:{label:"1"}},[e._v("电子邮件")]),s("el-checkbox",{attrs:{label:"2"}},[e._v("手机短信")])],1)],1)]),s("div",{staticClass:"lg-item"},[e._m(2),s("div",{staticClass:"lg-item-multi-line-value"},[s("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",placeholder:"所有公司"},on:{change:e.onCompanyOptionsChange},model:{value:e.selectedCompanyList,callback:function(t){e.selectedCompanyList=t},expression:"selectedCompanyList"}},e._l(e.companyOptions,function(e){return s("el-option",{key:e.companyId,attrs:{label:e.companyCode,value:e.companyId}})}),1),s("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",disabled:e.disableGroupSelector,placeholder:"所有托管机组"},model:{value:e.selectedGroupList,callback:function(t){e.selectedGroupList=t},expression:"selectedGroupList"}},e._l(e.groupOptions,function(e){return s("el-option",{key:e.groupId,attrs:{label:e.groupName,value:e.groupId}})}),1),s("div",{staticClass:"lg-item-multi-line-value receiver-item-value"},[s("el-checkbox-group",{model:{value:e.selectedRoleList,callback:function(t){e.selectedRoleList=t},expression:"selectedRoleList"}},[s("el-checkbox",{attrs:{label:"1"}},[e._v("交易员")]),s("el-checkbox",{attrs:{label:"2"}},[e._v("管理员")])],1)],1)],1)]),s("div",{staticClass:"sm-item"},[e._m(3),s("div",{staticClass:"sm-item-value"},[s("el-select",{staticClass:"sm-item-value",attrs:{filterable:"",placeholder:"请选择通知类型"},model:{value:e.selectedType,callback:function(t){e.selectedType=t},expression:"selectedType"}},e._l(e.M_TYPE,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1)],1)]),s("div",{staticClass:"sm-item"},[e._m(4),s("div",{staticClass:"sm-item-value"},[s("el-select",{staticClass:"sm-item-value",attrs:{filterable:"",placeholder:"请选择通知等级"},model:{value:e.selectedLevel,callback:function(t){e.selectedLevel=t},expression:"selectedLevel"}},e._l(e.M_LEVEL,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1)],1)]),s("div",{staticClass:"sm-item"},[e._m(5),s("div",{staticClass:"sm-item-value title-item-value"},[s("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.selectedTitle,callback:function(t){e.selectedTitle=t},expression:"selectedTitle"}})],1)]),s("div",{staticClass:"lg-item"},[s("div",{staticClass:"lg-item-key"},[s("span",[e._v("概要("+e._s(e.selectedSummaryCount)+"/45)")]),s("el-popover",{attrs:{placement:"bottom",title:e.SUMMARY_SMS_LIMIT.TITLE,width:"400",trigger:"click",content:e.SUMMARY_SMS_LIMIT.CONTENT}},[s("el-badge",{staticClass:"help-badge",attrs:{slot:"reference",type:"warning",value:"?"},slot:"reference"})],1)],1),s("div",{staticClass:"sm-item-auto-value summary-item-value"},[s("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入概要"},model:{value:e.selectedSummary,callback:function(t){e.selectedSummary=t},expression:"selectedSummary"}})],1)]),s("div",{staticClass:"lg-item"},[s("div",{staticClass:"lg-item-key"},[s("span",[e._v("内容")]),s("el-popover",{attrs:{placement:"bottom",title:e.MESSAGE_VARIABLE_USAGE.TITLE,width:"400",trigger:"click",content:e.MESSAGE_VARIABLE_USAGE.CONTENT}},[s("el-badge",{staticClass:"help-badge",attrs:{slot:"reference",type:"warning",value:"?"},slot:"reference"})],1)],1),s("div",{staticClass:"sm-item-auto-value content-item-value"},[s("Editor",{model:{value:e.editorContent,callback:function(t){e.editorContent=t},expression:"editorContent"}})],1)]),s("div",{staticClass:"sm-item"},[e._m(6),s("div",{staticClass:"sm-item-multi-value"},[s("el-button",{staticClass:"sm-item-multi-inner-button",attrs:{type:"primary"},on:{click:e.saveAsTemplate}},[e._v("保存")]),s("el-button",{staticClass:"sm-item-multi-inner-button",on:{click:e.previewTemplate}},[e._v("预览")])],1)]),s("d-message-preview",{attrs:{isShow:e.isShowPreviewDialog,messageContent:e.selectedMessageContent},on:{close:e.closePreview}})],1)},ve=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("模板名")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("发送途径")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"lg-item-key"},[s("span",[e._v("接收对象")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("通知类型")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("通知等级")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("标题")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span")])}],ge={name:"home",components:{Editor:b,"d-message-preview":R},data:function(){return{M_TYPE:this.$config.ENUM.M_TYPE.ITEMS,M_LEVEL:this.$config.ENUM.M_LEVEL.ITEMS,HOSTING_USER_ROLE:this.$config.ENUM.HOSTING_USER_ROLE.ITEMS,SUMMARY_SMS_LIMIT:this.$config.HELP.SUMMARY_SMS_LIMIT,MESSAGE_VARIABLE_USAGE:this.$config.HELP.MESSAGE_VARIABLE_USAGE,companyOptions:[],groupOptions:[],selectedTemplateName:null,selectedCompanyList:null,selectedGroupList:null,selectedRoleList:this.$config.ENUM.HOSTING_USER_ROLE.VALUES,selectedType:this.$config.ENUM.M_TYPE.ITEMS[0].KEY,selectedLevel:this.$config.ENUM.M_LEVEL.ITEMS[0].KEY,selectedTitle:null,selectedSummary:null,selectedSummaryCount:0,selectedChannelList:[],editorContent:"",disableGroupSelector:!0,isShowPreviewDialog:!1,selectedMessageContent:null}},mounted:function(){this.selectedChannelList=["4"],this.$util.resetNavigationStack(),this.$util.pushNavigationStack({name:"通知运行管理 模板管理",router:{path:"/template"}}),this.$util.pushNavigationStack({name:"新增模板",router:{path:"/addTemplate"}}),this.initQuery()},watch:{selectedSummary:function(){this.selectedSummaryCount=this.selectedSummary.length}},methods:{initQuery:function(){this.reqCompanyReceiver()},reqCompanyReceiver:function(){var e=this;this.$api.reqCompanyReceiver(function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||t.length<1)return void(e.companyOptions=[]);e.companyOptions=t}})},reqGroupReceiver:function(e){var t=this;this.$api.reqGroupReceiver(e,function(e){if(null!=e&&e.errorMsg)alert(e.errorMsg);else{if(null==e||e.length<1)return void(t.groupOptions=[]);t.groupOptions=e}})},onCompanyOptionsChange:function(){var e=this;this.$util.checkCompany(this.selectedCompanyList,function(t){1==e.selectedCompanyList.length&&t&&t.length>0?(e.groupOptions=t,e.disableGroupSelector=!1):1!=e.selectedCompanyList.length&&(e.groupOptions=[],e.selectedGroupList=[],e.disableGroupSelector=!0)})},getMessageContent:function(){var e=new MessageContent;return e.type=MType[this.selectedType],e.level=MLevel[this.selectedLevel],e.title=this.selectedTitle,e.summary=this.selectedSummary,e.content=this.editorContent,e},checkParams:function(){return this.selectedTemplateName?this.selectedTitle&&this.selectedTitle.length>32?(alert("标题字数过长，请重新填写"),1):this.selectedSummary&&this.selectedSummary.length>128?(alert("概要字数过长，请重新填写"),1):0:(alert("请输入模板名"),1)},saveAsTemplate:function(){if(!this.checkParams()){var e=this,t=new MBMessageTemplate;t.templateName=this.selectedTemplateName,t.policy=MSendingPolicy.MSP_NOW,this.selectedChannelList&&this.selectedChannelList.length>0&&(t.channelList=this.selectedChannelList),t.hostingList=this.$util.getMReceiverHostingList(this.selectedCompanyList,this.selectedGroupList,this.selectedRoleList),t.content=this.getMessageContent(),this.$api.addTemplate(t,function(t){null!=t?t.success?(alert("模板添加成功"),e.gotoTemplatePage()):t.message?alert(t.message):t.errorMsg?alert(t.errorMsg):alert(e.$string.message.callMethodFail):alert(e.$string.message.serverBusy)})}},gotoTemplatePage:function(){this.$router.push("/template")},previewTemplate:function(){this.selectedMessageContent={title:this.selectedTitle,summary:this.selectedSummary,content:this.editorContent},this.isShowPreviewDialog=!0},closePreview:function(){this.isShowPreviewDialog=!1}}},fe=ge,ye=(s("c9ea"),Object(n["a"])(fe,pe,ve,!1,null,"7bd509b2",null)),_e=ye.exports,Ce=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"sm-item"},[e._m(0),s("div",{staticClass:"sm-item-value"},[s("el-input",{attrs:{placeholder:"请输入模板名"},model:{value:e.selectedTemplateName,callback:function(t){e.selectedTemplateName=t},expression:"selectedTemplateName"}})],1)]),s("div",{staticClass:"item-divider"}),s("div",{staticClass:"sm-item"},[e._m(1),s("div",{staticClass:"sm-item-value long-item-value"},[s("el-checkbox-group",{model:{value:e.selectedChannelList,callback:function(t){e.selectedChannelList=t},expression:"selectedChannelList"}},[s("el-checkbox",{attrs:{label:"4"}},[e._v("客户端消息")]),s("el-checkbox",{attrs:{label:"1"}},[e._v("电子邮件")]),s("el-checkbox",{attrs:{label:"2"}},[e._v("手机短信")])],1)],1)]),s("div",{staticClass:"lg-item"},[e._m(2),s("div",{staticClass:"lg-item-multi-line-value"},[s("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",placeholder:"所有公司"},on:{change:e.onCompanyOptionsChange},model:{value:e.selectedCompanyList,callback:function(t){e.selectedCompanyList=t},expression:"selectedCompanyList"}},e._l(e.companyOptions,function(e){return s("el-option",{key:e.companyId,attrs:{label:e.companyCode,value:e.companyId}})}),1),s("el-select",{staticClass:"lg-item-multi-line-value receiver-item-value",attrs:{filterable:"",multiple:"",placeholder:"所有托管机组"},model:{value:e.selectedGroupList,callback:function(t){e.selectedGroupList=t},expression:"selectedGroupList"}},e._l(e.groupOptions,function(e){return s("el-option",{key:e.groupId,attrs:{label:e.groupName,value:e.groupId}})}),1),s("div",{staticClass:"lg-item-multi-line-value receiver-item-value"},[s("el-checkbox-group",{model:{value:e.selectedRoleList,callback:function(t){e.selectedRoleList=t},expression:"selectedRoleList"}},[s("el-checkbox",{attrs:{label:"1"}},[e._v("交易员")]),s("el-checkbox",{attrs:{label:"2"}},[e._v("管理员")])],1)],1)],1)]),s("div",{staticClass:"sm-item"},[e._m(3),s("div",{staticClass:"sm-item-value"},[s("el-select",{staticClass:"sm-item-value",attrs:{filterable:"",placeholder:"请选择通知类型"},model:{value:e.selectedType,callback:function(t){e.selectedType=t},expression:"selectedType"}},e._l(e.M_TYPE,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1)],1)]),s("div",{staticClass:"sm-item"},[e._m(4),s("div",{staticClass:"sm-item-value"},[s("el-select",{staticClass:"sm-item-value",attrs:{filterable:"",placeholder:"请选择通知等级"},model:{value:e.selectedLevel,callback:function(t){e.selectedLevel=t},expression:"selectedLevel"}},e._l(e.M_LEVEL,function(e){return s("el-option",{key:e.VALUE,attrs:{label:e.LABEL,value:e.KEY}})}),1)],1)]),s("div",{staticClass:"sm-item"},[e._m(5),s("div",{staticClass:"sm-item-value title-item-value"},[s("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.selectedTitle,callback:function(t){e.selectedTitle=t},expression:"selectedTitle"}})],1)]),s("div",{staticClass:"lg-item"},[s("div",{staticClass:"lg-item-key"},[s("span",[e._v("概要("+e._s(e.selectedSummaryCount)+"/45)")]),s("el-popover",{attrs:{placement:"bottom",title:e.SUMMARY_SMS_LIMIT.TITLE,width:"400",trigger:"click",content:e.SUMMARY_SMS_LIMIT.CONTENT}},[s("el-badge",{staticClass:"help-badge",attrs:{slot:"reference",type:"warning",value:"?"},slot:"reference"})],1)],1),s("div",{staticClass:"sm-item-auto-value summary-item-value"},[s("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入概要"},model:{value:e.selectedSummary,callback:function(t){e.selectedSummary=t},expression:"selectedSummary"}})],1)]),s("div",{staticClass:"lg-item"},[s("div",{staticClass:"lg-item-key"},[s("span",[e._v("内容")]),s("el-popover",{attrs:{placement:"bottom",title:e.MESSAGE_VARIABLE_USAGE.TITLE,width:"400",trigger:"click",content:e.MESSAGE_VARIABLE_USAGE.CONTENT}},[s("el-badge",{staticClass:"help-badge",attrs:{slot:"reference",type:"warning",value:"?"},slot:"reference"})],1)],1),s("div",{staticClass:"sm-item-auto-value content-item-value"},[s("Editor",{attrs:{initText:e.initEditorContent},model:{value:e.editorContent,callback:function(t){e.editorContent=t},expression:"editorContent"}})],1)]),s("div",{staticClass:"sm-item"},[e._m(6),s("div",{staticClass:"sm-item-multi-value"},[s("el-button",{staticClass:"sm-item-multi-inner-button",attrs:{type:"primary"},on:{click:e.updateTemplate}},[e._v("保存")]),s("el-button",{staticClass:"sm-item-multi-inner-button",on:{click:e.previewTemplate}},[e._v("预览")])],1)]),s("d-message-preview",{attrs:{isShow:e.isShowPreviewDialog,messageContent:e.selectedMessageContent},on:{close:e.closePreview}})],1)},Ee=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("模板名")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("发送途径")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"lg-item-key"},[s("span",[e._v("接收对象")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("通知类型")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("通知等级")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span",[e._v("标题")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sm-item-key"},[s("span")])}],Le={name:"home",components:{Editor:b,"d-message-preview":R},data:function(){return{M_TYPE:this.$config.ENUM.M_TYPE.ITEMS,M_LEVEL:this.$config.ENUM.M_LEVEL.ITEMS,HOSTING_USER_ROLE:this.$config.ENUM.HOSTING_USER_ROLE.ITEMS,M_LEVEL_MAP:this.$config.ENUM.M_LEVEL.MAP,SUMMARY_SMS_LIMIT:this.$config.HELP.SUMMARY_SMS_LIMIT,MESSAGE_VARIABLE_USAGE:this.$config.HELP.MESSAGE_VARIABLE_USAGE,selectedTemplate:null,companyOptions:[],groupOptions:[],selectedTemplateName:null,selectedCompanyList:null,selectedGroupList:null,selectedRoleList:this.$config.ENUM.HOSTING_USER_ROLE.VALUES,selectedType:this.$config.ENUM.M_TYPE.ITEMS[0].KEY,selectedLevel:this.$config.ENUM.M_LEVEL.ITEMS[0].KEY,selectedTitle:null,selectedSummary:null,selectedSummaryCount:null,selectedChannelList:[],editorContent:"",initEditorContent:"",isShowPreviewDialog:!1,selectedMessageContent:null}},mounted:function(){this.selectedChannelList=["4"],this.$util.resetNavigationStack(),this.$util.pushNavigationStack({name:"通知运行管理 模板管理",router:{path:"/template"}}),this.$util.pushNavigationStack({name:"编辑模板",router:{path:"/editTemplate"}}),this.getQueryParams(),this.initQuery()},watch:{selectedSummary:function(){this.selectedSummaryCount=this.selectedSummary.length}},methods:{getQueryParams:function(){this.selectedTemplate=this.$route.query.template,this.applyTemplate()},initQuery:function(){this.reqCompanyReceiver()},reqCompanyReceiver:function(){var e=this;this.$api.reqCompanyReceiver(function(t){if(null!=t&&t.errorMsg)alert(t.errorMsg);else{if(null==t||t.length<1)return void(e.companyOptions=[]);e.companyOptions=t}})},reqGroupReceiver:function(e){var t=this;this.$api.reqGroupReceiver(e,function(e){if(null!=e&&e.errorMsg)alert(e.errorMsg);else{if(null==e||e.length<1)return void(t.groupOptions=[]);t.groupOptions=e}})},onCompanyOptionsChange:function(){var e=this;this.$util.checkCompany(this.selectedCompanyList,function(t){1==e.selectedCompanyList.length&&t&&t.length>0?(e.groupOptions=t,e.disableGroupSelector=!1):1!=e.selectedCompanyList.length&&(e.groupOptions=[],e.selectedGroupList=[],e.disableGroupSelector=!0)})},applyTemplate:function(){if(this.selectedTemplate){this.selectedTemplateName=this.selectedTemplate.templateName,this.selectedChannelList=this.$util.getStringChannelList(this.selectedTemplate.channelList),this.selectedCompanyList=this.$util.getCompanyListFromHostingList(this.selectedTemplate.hostingList),1==this.selectedCompanyList.length?(this.reqGroupReceiver(this.selectedCompanyList[0]),this.disableGroupSelector=!1):this.disableGroupSelector=!0,this.selectedGroupList=this.$util.getGroupListFromHostingList(this.selectedTemplate.hostingList),this.selectedRoleList=this.$util.getRoleListFromHostingList(this.selectedTemplate.hostingList),this.selectedType=this.M_TYPE[this.selectedTemplate.content.type].KEY,this.selectedLevel=this.M_LEVEL_MAP[this.selectedTemplate.content.level].KEY,this.selectedTitle=this.selectedTemplate.content.title,this.selectedSummary=this.selectedTemplate.content.summary,this.selectedSummary&&(this.selectedSummaryCount=this.selectedSummary.length);var e=this;this.$util.getRTFContent(this.selectedTemplate.content.content,function(t){e.initEditorContent=t,e.editorContent=t})}},getMessageContent:function(){var e=new MessageContent;return e.type=MType[this.selectedType],e.level=MLevel[this.selectedLevel],e.title=this.selectedTitle,e.summary=this.selectedSummary,e.content=this.editorContent,e},checkParams:function(){return this.selectedTemplate&&this.selectedTemplate.templateId?this.selectedTemplateName?this.selectedTitle&&this.selectedTitle.length>32?(alert("标题字数过长，请重新填写"),1):this.selectedSummary&&this.selectedSummary.length>128?(alert("概要字数过长，请重新填写"),1):0:(alert("请输入模板名"),1):(alert("页面过期，请尝试刷新后重试"),1)},updateTemplate:function(){if(!this.checkParams()){var e=this,t=new MBMessageTemplate;t.templateId=this.selectedTemplate.templateId,t.templateName=this.selectedTemplateName,t.policy=MSendingPolicy.MSP_NOW,this.selectedChannelList&&this.selectedChannelList.length>0&&(t.channelList=this.selectedChannelList),t.hostingList=this.$util.getMReceiverHostingList(this.selectedCompanyList,this.selectedGroupList,this.selectedRoleList),t.content=this.getMessageContent(),this.$api.updateTemplate(t,function(t){null!=t?t.success?(alert("模板修改成功"),e.gotoTemplatePage()):t.message?alert(t.message):t.errorMsg?alert(t.errorMsg):alert(e.$string.message.callMethodFail):alert(e.$string.message.serverBusy)})}},gotoTemplatePage:function(){this.$router.push("/template")},previewTemplate:function(){this.selectedMessageContent={title:this.selectedTitle,summary:this.selectedSummary,content:this.editorContent},this.isShowPreviewDialog=!0},closePreview:function(){this.isShowPreviewDialog=!1}}},Me=Le,Se=(s("a60c"),Object(n["a"])(Me,Ce,Ee,!1,null,"a5c23df4",null)),Te=Se.exports;i["default"].use(u["a"]);var be=new u["a"]({routes:[{path:"/",name:"home",component:g,redirect:"/sending",children:[{path:"/sending",name:"sendingMessage",component:V},{path:"/sent",name:"sentMessage",component:te},{path:"/errorMessage",name:"errorMessage",component:oe},{path:"/template",name:"template",component:he},{path:"/addTemplate",name:"addTemplate",component:_e},{path:"/editTemplate",name:"editTemplate",component:Te}]}]}),ke=s("2f62");i["default"].use(ke["a"]);var Ae=new ke["a"].Store({state:{navigationStack:[{name:"通知运行管理 发送通知",router:{path:"/sending"}}]},mutations:{resetNavigationStack:function(e){e.navigationStack=[]},pushNavigationStack:function(e,t){e.navigationStack.push(t)}},actions:{}}),Ne=s("5c96"),Ie=s.n(Ne);s("0fae");i["default"].use(Ie.a);s("3b2b"),s("a481");Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var s in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+s+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[s]:("00"+t[s]).substr((""+t[s]).length)));return e};var we={getYYYY_MM_DD_HH_MM_SS:function(e){return new Date(e).Format("yyyy-MM-dd hh:mm:ss")}},Re=s("e814"),Oe=s.n(Re),Pe={PROXY_ROUTER:{LOCALHOST:{HOST:"localhost:8080",PROXY_HOST:"https://devproxy.xueqiao.cn"},DEV:{HOST:"errorcode-manager.devoa.xueqiao.cn",PROXY_HOST:"https://devproxy.xueqiao.cn"},GAMMA:{HOST:"errorcode-manager.gaoa.xueqiao.cn",PROXY_HOST:"https://gaproxy.xueqiao.cn"},IDC:{HOST:"errorcode-manager.oa.xueqiao.cn",PROXY_HOST:"https://proxy.xueqiao.cn"}},HELP:{MESSAGE_VARIABLE_USAGE:{DESCRIPTION:"信箱消息发送渠道",TITLE:"消息变量使用说明",CONTENT:"消息内容中可以使用消息变量。使用消息变量，发送时，会替换成对应的变量值。 {{userName}} : 用户中文名; {{companyCode}} : 公司登录名。"},SUMMARY_SMS_LIMIT:{DESCRIPTION:"阿里云短信限制说明",TITLE:"概要说明",CONTENT:"概要的内容主要做为手机短信的内容。根据阿里云上的短信限制。我们推荐的概要字数为45，但不会强制要求。如果概要字数超过45时，短信有可能会分为多条发送（也会按多条短信计费）。"}},ENUM:{M_SENDING_CHANNEL:{DESCRIPTION:"信箱消息发送渠道",ITEMS:[{KEY:"MSC_MAIL",VALUE:1,LABEL:"电子邮件"},{KEY:"MSC_SMS",VALUE:2,LABEL:"手机短信"},{KEY:"MSC_HOSTING",VALUE:4,LABEL:"客户端消息"}],MAP:{1:{KEY:"MSC_MAIL",VALUE:1,LABEL:"电子邮件"},2:{KEY:"MSC_SMS",VALUE:2,LABEL:"手机短信"},4:{KEY:"MSC_HOSTING",VALUE:4,LABEL:"客户端消息"}}},M_TYPE:{DESCRIPTION:"信箱消息类型",ITEMS:[{KEY:"TYPE_XUEQIAO_NOTICE",VALUE:0,LABEL:"雪橇通知"},{KEY:"TYPE_SYSTEM_NOTICE",VALUE:1,LABEL:"系统通知"},{KEY:"TYPE_EXCHANGE_NOTICE",VALUE:2,LABEL:"交易所通知"},{KEY:"TYPE_MARKETING_PROMOTION",VALUE:3,LABEL:"营销推广"}]},M_LEVEL:{DESCRIPTION:"信箱消息级别",ITEMS:[{KEY:"LEVEL_LOW",VALUE:0,LABEL:"一般"},{KEY:"LEVEL_MEDIUM",VALUE:10,LABEL:"重要"},{KEY:"LEVEL_HIGH",VALUE:20,LABEL:"紧急"}],MAP:{0:{KEY:"LEVEL_LOW",VALUE:0,LABEL:"一般"},10:{KEY:"LEVEL_MEDIUM",VALUE:10,LABEL:"重要"},20:{KEY:"LEVEL_HIGH",VALUE:20,LABEL:"紧急"}}},HOSTING_USER_ROLE:{DESCRIPTION:"托管机用户角色",ITEMS:[{KEY:"TRADER",VALUE:1,LABEL:"交易员"},{KEY:"ADMIN",VALUE:2,LABEL:"管理员"}],VALUES:["1","2"]},M_JOB_STATUS:{DESCRIPTION:"信箱消息实例状态",ITEMS:[{KEY:"MJS_SENDING",VALUE:0,LABEL:"发送中"},{KEY:"MJS_COMPLETED",VALUE:1,LABEL:"完成"},{KEY:"MJS_EXCEPTION_STOP",VALUE:2,LABEL:"异常停止"},{KEY:"MJS_NETWORK_ERROR_RETRY",VALUE:3,LABEL:"错误重试中"},{KEY:"MJS_NETWORK_ERROR_STOP",VALUE:4,LABEL:"网络错误停止"}],VALUES:["0","1","2","3","4"]}}},xe=s("f499"),$e=s.n(xe),Ue=(s("4917"),{getCookie:function(e){var t,s=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(s))?t[2]:null},setCookie:function(e,t,s,i){var a=new Date;a.setDate(a.getDate()+s),document.cookie=e+"="+escape(t)+(null==s?"":";expires="+a.toGMTString())+(null==i?"":";domain="+i)}}),Ke={message:{callMethodFail:"接口调用失败",serverBusy:"服务繁忙"}},Ge=new Thrift.Transport(""),Be=new Thrift.Protocol(Ge),qe=new MailboxWebapiClient(Be),Ye={reqMBMessageTemplateSelector:function(e){var t=qe.send_reqMBMessageTemplateSelector(new PlatformArgs);this.doHttpPost(t,function(){var t=null;try{t=qe.recv_reqMBMessageTemplateSelector(),e(t)}catch(i){var s=$e()(i);"{}"!=s?alert(s):alert(i)}},function(){var t={errorCode:-1,errorMsg:Ke.message.callMethodFail};e(t)})},reqCompanyReceiver:function(e){var t=qe.send_reqCompanyReceiver(new PlatformArgs);this.doHttpPost(t,function(){var t=null;try{t=qe.recv_reqCompanyReceiver(),e(t)}catch(i){var s=$e()(i);"{}"!=s?alert(s):alert(i)}},function(){var t={errorCode:-1,errorMsg:Ke.message.callMethodFail};e(t)})},reqGroupReceiver:function(e,t){var s=qe.send_reqGroupReceiver(new PlatformArgs,e);this.doHttpPost(s,function(){var e=null;try{e=qe.recv_reqGroupReceiver(),t(e)}catch(i){var s=$e()(i);"{}"!=s?alert(s):alert(i)}},function(){var e={errorCode:-1,errorMsg:Ke.message.callMethodFail};t(e)})},addMBMessage:function(e,t){var s=qe.send_addMBMessage(new PlatformArgs,e);this.doHttpPost(s,function(){var e=null;try{e=qe.recv_addMBMessage(),t(e)}catch(i){var s=$e()(i);"{}"!=s?alert("ei : "+s):alert(i)}},function(){var e={errorCode:-1,errorMsg:Ke.message.callMethodFail};t(e)})},addTemplate:function(e,t){var s=qe.send_addTemplate(new PlatformArgs,e);this.doHttpPost(s,function(){var e=null;try{e=qe.recv_addTemplate(),t(e)}catch(i){var s=$e()(i);"{}"!=s?alert(s):alert(i)}},function(){var e={errorCode:-1,errorMsg:Ke.message.callMethodFail};t(e)})},updateTemplate:function(e,t){var s=qe.send_updateTemplate(new PlatformArgs,e);this.doHttpPost(s,function(){var e=null;try{e=qe.recv_updateTemplate(),t(e)}catch(i){var s=$e()(i);"{}"!=s?alert(s):alert(i)}},function(){var e={errorCode:-1,errorMsg:Ke.message.callMethodFail};t(e)})},reqTemplate:function(e,t,s){var i=qe.send_reqTemplate(new PlatformArgs,e,t);this.doHttpPost(i,function(){var e=null;try{e=qe.recv_reqTemplate(),s(e)}catch(i){var t=$e()(i);"{}"!=t?alert(t):alert(i)}},function(){var e={errorCode:-1,errorMsg:Ke.message.callMethodFail};s(e)})},removeTemplate:function(e,t){var s=qe.send_removeTemplate(new PlatformArgs,e);this.doHttpPost(s,function(){var e=null;try{e=qe.recv_removeTemplate(),t(e)}catch(i){var s=$e()(i);"{}"!=s?alert(s):alert(i)}},function(){var e={errorCode:-1,errorMsg:Ke.message.callMethodFail};t(e)})},reqMBMessageJob:function(e,t,s){var i=qe.send_reqMBMessageJob(new PlatformArgs,e,t);this.doHttpPost(i,function(){var e=null;try{e=qe.recv_reqMBMessageJob(),s(e)}catch(i){var t=$e()(i);"{}"!=t?alert(t):alert(i)}},function(){var e={errorCode:-1,errorMsg:Ke.message.callMethodFail};s(e)})},reqContentText:function(e,t){var s=qe.send_reqContentText(new PlatformArgs,e);this.doHttpPost(s,function(){var e=null;try{e=qe.recv_reqContentText(),t(e)}catch(i){var s=$e()(i);"{}"!=s?alert(s):alert(i)}},function(){var e={errorCode:-1,errorMsg:Ke.message.callMethodFail};t(e)})},updateMessageJobStatus:function(e,t,s){var i=qe.send_updateMessageJobStatus(new PlatformArgs,e,t);this.doHttpPost(i,function(){var e=null;try{e=qe.recv_updateMessageJobStatus(),s(e)}catch(i){var t=$e()(i);"{}"!=t?alert(t):alert(i)}},function(){var e={errorCode:-1,errorMsg:Ke.message.callMethodFail};s(e)})},doHttpPost:function(e,t,s){var i=this.getProxyHost();if(i){var a=i+"?servant=mailbox_webapi";$.ajax({url:a,data:e,type:"POST",cache:!1,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("X-Oa-Falcon-Sig",Ue.getCookie("oa_falcon_sig")),e.setRequestHeader("X-Oa-User-Id",Ue.getCookie("oa_user_id")),e.setRequestHeader("X-Oa-User-Name",Ue.getCookie("oa_user_name")),e.setRequestHeader("X-Oa-User-Secret",Ue.getCookie("oa_user_secret"))},success:function(e){Ge.setRecvBuffer(e),t()},error:function(){s()}})}else alert("proxyHost is empty, please refresh and try again")},getProxyHost:function(){var e=window.location.host;return"192.168.0.62:8080"===e?"http://mailbox.devoa.xueqiao.cn/webapi":"localhost:8080"==e?"http://mailbox.devoa.xueqiao.cn/webapi":"/webapi"}},Ve={reqGroupReceiver:function(e,t){Ye.reqGroupReceiver(e,function(e){if(null!=e&&e.errorMsg)alert(e.errorMsg);else{if(null==e||e.length<1)return void t([]);t(e)}})}},De={resetNavigationStack:function(){Ae.commit("resetNavigationStack")},pushNavigationStack:function(e){Ae.commit("pushNavigationStack",e)},getCompanyListFromHostingList:function(e){if(!e||e.length<1)return[];for(var t=[],s=0;s<e.length;s++)-1==t.indexOf(e[s].companyId)&&t.push(e[s].companyId);return 1==t.length&&0==t[0]?[]:t},getGroupListFromHostingList:function(e){if(!e||e.length<1)return[];for(var t=[],s=0;s<e.length;s++)-1==t.indexOf(e[s].groupId)&&t.push(e[s].groupId);return 1==t.length&&0==t[0]?[]:t},getRoleListFromHostingList:function(e){if(!e||e.length<1||!e[0].roleList||e[0].roleList.length<1)return Pe.ENUM.HOSTING_USER_ROLE.VALUES;for(var t=[],s=0;s<e[0].roleList.length;s++)t.push(String(e[0].roleList[s]));return t},getStringChannelList:function(e){var t=[];if(e&&e.length>0)for(var s=0;s<e.length;s++)t.push(String(e[s]));return t},getRTFContent:function(e,t){Ye.reqContentText(e,function(e){if(!e&&e.errorMsg)alert("error : "+e.errorMsg);else{if(e&&e.contentText)return void t(e.contentText);t(null)}})},getMReceiverHostingList:function(e,t,s){for(var i=[],a=0;a<s.length;a++)i.push(Oe()(s[a]));var l=[],n=null;if(!e||e.length<1)n=new MReceiverHosting,n.companyId=0,n.groupId=0,n.roleList=i,l.push(n);else if(e.length>1)for(a=0;a<e.length;a++)n=new MReceiverHosting,n.companyId=e[a],n.groupId=0,n.roleList=i,l.push(n);else if(!t||t.length<1)n=new MReceiverHosting,n.companyId=e[0],n.groupId=0,n.roleList=i,l.push(n);else for(a=0;a<t.length;a++)n=new MReceiverHosting,n.companyId=e[0],n.groupId=t[a],n.roleList=i,l.push(n);return l},checkCompany:function(e,t){if(e&&e.length>0){var s=e[e.length-1];Ve.reqGroupReceiver(s,function(s){s&&s.length>0?t(s):(alert("该公司还没有开通托管机，不能选择该公司"),e.splice(e.length-1,1),t(null))})}else t(null)},genHTMLContent:function(e){var t="<html><header><style>table {border-top: 1px solid #ccc;border-left: 1px solid #ccc;}table td,table th {border-bottom: 1px solid #ccc;border-right: 1px solid #ccc;padding: 3px 5px;}table th {border-bottom: 2px solid #ccc;text-align: center;}blockquote {display: block;border-left: 8px solid #d0e5f2;padding: 5px 10px;margin: 10px 0;line-height: 1.4;font-size: 100%;background-color: #f1f1f1;}</style></header><body>",s="</body></html>";return t+e+s}},He={navigationStack:[],methods:{resetNavigationStack:function(){this.navigationStack=[]},pushNavigationStack:function(e){this.navigationStack.push(e)}}};s("aede"),s("267d"),s("1101");i["default"].config.productionTip=!1,i["default"].prototype.$timeUtil=we,i["default"].prototype.$util=De,i["default"].prototype.$apiUtil=Ve,i["default"].prototype.$api=Ye,i["default"].prototype.$cookie=Ue,i["default"].prototype.$cache=He,i["default"].prototype.$config=Pe,new i["default"]({router:be,store:Ae,render:function(e){return e(c)}}).$mount("#app")},"64a9":function(e,t,s){},"68f3":function(e,t,s){"use strict";var i=s("b4ba"),a=s.n(i);a.a},"6cef":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAORJREFUOBGlU9sNwiAUhTJDdzBxBxP9ZJeO4I+O0F34beIOJt3BIfAc5BqQR016E9ILnHPuqyjv/eCcu2GN6k8jlhxydXSuWusn+Gdr7aunEwMtIB/BuQ8AzyTzAP4SAVWNHzIDzprIykWRSQsTBLZEWmTyvgItEZ7DpOaiT5kAkWk0bFeewQ6tJhcCRFMETX2QyD1shcCpNiFOYZcVAlICVBmdJXDRr444K0HI8ScJDQORtt3EGllq7t2FDHqATwL5dNKJ8C2MvRRFgN8alk2c0pol7ZQoPu+MMZfk7UwK5F3P+Q1/IdpMdUOBIAAAAABJRU5ErkJggg=="},8099:function(e,t,s){},a60c:function(e,t,s){"use strict";var i=s("37c6"),a=s.n(i);a.a},aede:function(e,t,s){},b2f2:function(e,t,s){"use strict";var i=s("b338"),a=s.n(i);a.a},b338:function(e,t,s){},b4ba:function(e,t,s){},be5d:function(e,t,s){"use strict";var i=s("4b46"),a=s.n(i);a.a},c02c:function(e,t,s){"use strict";var i=s("1ca1"),a=s.n(i);a.a},c9ea:function(e,t,s){"use strict";var i=s("337d"),a=s.n(i);a.a},dfe0:function(e,t,s){"use strict";var i=s("4ef7"),a=s.n(i);a.a},ff13:function(e,t,s){"use strict";var i=s("089a"),a=s.n(i);a.a}});
//# sourceMappingURL=app.b1eee787.js.map